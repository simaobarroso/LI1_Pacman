<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tarefa1</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Tarefa1</p></div><div id="description"><p class="caption">Description</p><div class="doc"><h1>Realiza&#231;&#227;o da <strong><em>Tarefa1</em></strong></h1></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:generateRandoms">generateRandoms</a> :: Int -&gt; Int -&gt; [Int]</li><li class="src short"><a href="#v:nrAleatorio">nrAleatorio</a> :: Int -&gt; Int</li><li class="src short"><a href="#v:subLista">subLista</a> :: Int -&gt; [a] -&gt; [[a]]</li><li class="src short"><a href="#v:convertPiece">convertPiece</a> :: Int -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a></li><li class="src short"><a href="#v:printCorridor">printCorridor</a> :: <a href="Types.html#t:Corridor" title="Types">Corridor</a> -&gt; String</li><li class="src short"><a href="#v:converteCorredor">converteCorredor</a> :: [Int] -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></li><li class="src short"><a href="#v:converteLabirinto">converteLabirinto</a> :: [[Int]] -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:ghostHome">ghostHome</a> :: Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:walls">walls</a> :: Int -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></li><li class="src short"><a href="#v:walls2">walls2</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:limMaze">limMaze</a> :: Int -&gt; Int -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:createMiddle">createMiddle</a> :: Int -&gt; Int -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:unir">unir</a> :: Int -&gt; Int -&gt; Int -&gt; [<a href="Types.html#t:Corridor" title="Types">Corridor</a>]</li><li class="src short"><a href="#v:ghostpart">ghostpart</a> :: Int -&gt; Int -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:taken1">taken1</a> :: [[a]] -&gt; Int -&gt; [a]</li><li class="src short"><a href="#v:mazetocorridor">mazetocorridor</a> :: Int -&gt; Int -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:replaceInList">replaceInList</a> :: Int -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a> -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a> -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a></li><li class="src short"><a href="#v:replaceIncorridorOdd">replaceIncorridorOdd</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; Int -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:replaceIncorridorEven">replaceIncorridorEven</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; Int -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:generateMaze">generateMaze</a> :: Int -&gt; Int -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:imprimeLabirinto">imprimeLabirinto</a> :: Int -&gt; Int -&gt; Int -&gt; IO ()</li><li class="src short"><a href="#v:testaGeraLabirinto">testaGeraLabirinto</a> :: Int -&gt; Int -&gt; Int -&gt; Bool</li><li class="src short"><a href="#v:altura">altura</a> :: Int -&gt; Int -&gt; Int -&gt; Bool</li><li class="src short"><a href="#v:comprimento">comprimento</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; Bool</li><li class="src short"><a href="#v:scnd">scnd</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:generateRandoms" class="def">generateRandoms</a> :: Int -&gt; Int -&gt; [Int] <a href="#v:generateRandoms" class="selflink">#</a></p><div class="doc"><p>A Fun&#231;&#227;o generateRandoms dada uma semente, retorna uma lista n inteiros gerada aliatoriamente</p><p>generateRandoms n seed = let gen = mkStdGen seed -&gt;  cria um gerador aleatorio</p><p>in take n $ randomRs (0,99) gen -&gt; pega nos primeiros n elementos numa serie infinita de numeros aleatorios entre 0 e 99</p></div></div><div class="top"><p class="src"><a id="v:nrAleatorio" class="def">nrAleatorio</a> :: Int -&gt; Int <a href="#v:nrAleatorio" class="selflink">#</a></p><div class="doc"><p>N&#250;mero aliat&#243;rio gerado com uma seed</p></div></div><div class="top"><p class="src"><a id="v:subLista" class="def">subLista</a> :: Int -&gt; [a] -&gt; [[a]] <a href="#v:subLista" class="selflink">#</a></p><div class="doc"><p>Converte uma lista numa lista de lista de tamanho n </p></div></div><div class="top"><p class="src"><a id="v:convertPiece" class="def">convertPiece</a> :: Int -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a> <a href="#v:convertPiece" class="selflink">#</a></p><div class="doc"><p>Converte um Integer numa Piece
| x == 3 = Food Big -&gt; 3 <a href="=">=</a> Food Big
| x &gt;= 0 &amp;&amp;  x <a href="70">= Food Little -</a> 0 <a href="=">n &lt; 70 &lt;=</a> Food Little
| otherwise = Wall -&gt; 70 <a href="n">&lt;= 99 &lt;=</a> Wall</p></div></div><div class="top"><p class="src"><a id="v:printCorridor" class="def">printCorridor</a> :: <a href="Types.html#t:Corridor" title="Types">Corridor</a> -&gt; String <a href="#v:printCorridor" class="selflink">#</a></p><div class="doc"><p>Converte um Corridor numa string </p></div></div><div class="top"><p class="src"><a id="v:converteCorredor" class="def">converteCorredor</a> :: [Int] -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a> <a href="#v:converteCorredor" class="selflink">#</a></p><div class="doc"><p>Converte uma lista de Integers num Corridor</p></div></div><div class="top"><p class="src"><a id="v:converteLabirinto" class="def">converteLabirinto</a> :: [[Int]] -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:converteLabirinto" class="selflink">#</a></p><div class="doc"><p>Converte uma lista de listas de Integers num Maze </p></div></div><div class="top"><p class="src"><a id="v:ghostHome" class="def">ghostHome</a> :: Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:ghostHome" class="selflink">#</a></p><div class="doc"><p>Formato da casa dos Corridores da casa fantasma. Dependendo do tamanho dos corridores do maze, o tamanho da casa dos fantasmas tamb&#233;m varia
 | No caso de comprimento do labirinto ser par, a entrada da casa fantasma vai ter comprimento 2, de maneira a ficar centralizada
 | No caso de o comprimento do labirinto ser &#237;mpar, a entrada da casa fantasma vai ter comprimento 3, de maneira a ficar centralizada</p></div></div><div class="top"><p class="src"><a id="v:walls" class="def">walls</a> :: Int -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a> <a href="#v:walls" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o walls cria um Corridor cheio de Paredes (para as paredes inferior de superiores)  </p></div></div><div class="top"><p class="src"><a id="v:walls2" class="def">walls2</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:walls2" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o walls2 adiciona paredes laterais &#224; volta do Maze </p></div></div><div class="top"><p class="src"><a id="v:limMaze" class="def">limMaze</a> :: Int -&gt; Int -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:limMaze" class="selflink">#</a></p><div class="doc"><p>Junta as paredes superiores e inferiores com o restante do maze  
 | limMaze x y z = (walls x) : (walls2  (createMiddle (x-2) (y-2) z)) ++ [(walls x)] -&gt; Ger&#225;mos (x-2) e (y-2) devido &#224; coloca&#231;&#227;o das paredes no fim e in&#237;cio dos Corridores (excepto o primeiro e &#250;ltimo)</p></div></div><div class="top"><p class="src"><a id="v:createMiddle" class="def">createMiddle</a> :: Int -&gt; Int -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:createMiddle" class="selflink">#</a></p><div class="doc"><p>Gera aliatoriamente as Pieces que constituem os restantes Corridores</p></div></div><div class="top"><p class="src"><a id="v:unir" class="def">unir</a> :: Int -&gt; Int -&gt; Int -&gt; [<a href="Types.html#t:Corridor" title="Types">Corridor</a>] <a href="#v:unir" class="selflink">#</a></p><div class="doc"><p>A Fun&#231;&#227;o unir une a 3 partes de um labirinto:</p><p>A de cima </p><p>A do meio (contituida pelos t&#250;neis e pela casa fantasma)</p><p>A de baixo (obtida atrav&#233;s de tirarmos as outras duas de um labirnto)</p><p>Quando o y &#233; par retiramos div y 2 - 2 pois a casa fantasma tem de estar &#8203; X-1 pe&#231;as de dist&#226;ncia da parede superior </p><p>Sendo o y &#237;mpar, o labirinto vai ter o mesmo n&#250;mero de corridores para cima e para baixo do corridor do T&#250;nel (nx+5 pois o labirinto vai ter 5 corridores)</p><p>O &quot;nx       = div y 2 - 2&quot;  &#233; numero de corredores da parte de cima que n&#227;o s&#227;o &quot;influenciados&quot; pelo labirinto</p></div></div><div class="top"><p class="src"><a id="v:ghostpart" class="def">ghostpart</a> :: Int -&gt; Int -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:ghostpart" class="selflink">#</a></p><div class="doc"><p>Trata de juntar o que vem antes e depois com a casa dos fantasmas nos seus varios corredores</p></div></div><div class="top"><p class="src"><a id="v:taken1" class="def">taken1</a> :: [[a]] -&gt; Int -&gt; [a] <a href="#v:taken1" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o auxiliar. Utilizamos esta fun&#231;&#227;o para 
taken1 [[]] _ = []  Base da recurs&#227;o. No caso do n &gt; numero de Corridores do maze, ent&#227;o vai dar um Corridor vazio 
taken1 (x:xs) n | n == 1 = x  No caso de queremos o 1&#186; Corridor
                | n /= 1 = taken1 xs (n-1) eliminamos o 1&#186; Corridor porque n&#227;o era esse que procuravamos, chamando a fun&#231;&#227;o recursivamente                </p></div></div><div class="top"><p class="src"><a id="v:mazetocorridor" class="def">mazetocorridor</a> :: Int -&gt; Int -&gt; Int -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:mazetocorridor" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o auxiliar. Retira os Corridores que v&#227;o ser afetados pela inser&#231;&#227;o da casa dos fantasmas no maze</p></div></div><div class="top"><p class="src"><a id="v:replaceInList" class="def">replaceInList</a> :: Int -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a> -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a> -&gt; <a href="Types.html#t:Corridor" title="Types">Corridor</a> <a href="#v:replaceInList" class="selflink">#</a></p><div class="doc"><p>Substitui uma lista de indice 0 por uma pe&#231;a                 </p></div></div><div class="top"><p class="src"><a id="v:replaceIncorridorOdd" class="def">replaceIncorridorOdd</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; Int -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:replaceIncorridorOdd" class="selflink">#</a></p><div class="doc"><p>Substitui uma pe&#231;a num Labirinto para meter os tuneis (Impares)
 | Num Maze cujo Y seja &#237;mpar apenas vamos inserir um t&#250;nel (exatamente a metade)</p></div></div><div class="top"><p class="src"><a id="v:replaceIncorridorEven" class="def">replaceIncorridorEven</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; Int -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:replaceIncorridorEven" class="selflink">#</a></p><div class="doc"><p>Substitui uma pe&#231;a num Labirinto para meter os tuneis (Pares)</p></div></div><div class="top"><p class="src"><a id="v:generateMaze" class="def">generateMaze</a> <a href="#v:generateMaze" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>largura</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>seed</p></td></tr><tr><td class="src">-&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></td><td class="doc"><p>O Maze Final</p></td></tr></table></div><div class="doc"><p>Gera o maze 
 | O labirinto deve conter no minimo 15 de comprimento e 10 de altura ec hamamos a fun&#231;&#227;o unir que nos devolve um Labirinto (Maze) que cumpre os v&#225;rios requisitos </p></div></div><div class="top"><p class="src"><a id="v:imprimeLabirinto" class="def">imprimeLabirinto</a> :: Int -&gt; Int -&gt; Int -&gt; IO () <a href="#v:imprimeLabirinto" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o auxiliar. Permite um melhor visionamento da fun&#231;&#227;o generateMaze com o objetivo de detetar potenciais erros</p></div></div><div class="top"><p class="src"><a id="v:testaGeraLabirinto" class="def">testaGeraLabirinto</a> :: Int -&gt; Int -&gt; Int -&gt; Bool <a href="#v:testaGeraLabirinto" class="selflink">#</a></p><div class="doc"><p><strong>Dicion&#225;rio de vari&#225;veis</strong> (Para efeitos ilustrativos, nesta parte s&#227;o melhor definidas as vari&#225;veis mais utilizadas ao longo da Tarefa1) :</p><p>mazeEven -&gt; Labirinto cujo y &#233; &#237;mpar, ou seja, o tunel vai ter 1 de altura</p><p>mazeOdd  -&gt; Labirinto cujo y &#233; par  , ou seja, o tunel vai ter 2 de altura</p><p>ghostH   -&gt; A casa fantasma (que varia de comprimento se o x &#233; par ou &#237;mpar)</p><p>nxh      -&gt; N&#250;mero de pe&#231;as no inicio do corridor n&#227;o afetadas pela introdu&#231;&#227;o da casa fantasma (no caso de x par)</p><p>nxt      -&gt; N&#250;mero de pe&#231;as no fim do corridor n&#227;o afetadas pela introdu&#231;&#227;o da casa fantasma (no caso de x par)</p><p>nxho     -&gt; N&#250;mero de pe&#231;as no inicio do corridor n&#227;o afetadas pela introdu&#231;&#227;o da casa fantasma (no caso de x &#237;mpar)</p><p>nxto     -&gt; N&#250;mero de pe&#231;as no fim do corridor n&#227;o afetadas pela introdu&#231;&#227;o da casa fantasma (no caso de x &#237;mpar) </p><p>ghostP   -&gt; Lista dos v&#225;rios corredores onde a GhostHome (casa dos fantasmas) est&#225; inserida</p><p>t2mazeE  -&gt; Tira o Corridor 2 do labirinto resultante da fun&#231;&#227;o mazetocorridor de um labirinto par  </p><p>t3mazeE  -&gt; Tira o Corridor 3 do labirinto resultante da fun&#231;&#227;o mazetocorridor de um labirinto par</p><p>t4mazeE  -&gt; Tira o Corridor 4 do labirinto resultante da fun&#231;&#227;o mazetocorridor de um labirinto par</p><p>t5mazeE  -&gt; Tira o Corridor 5 do labirinto resultante da fun&#231;&#227;o mazetocorridor de um labirinto par</p><p>t2maze0  -&gt; Tira o Corridor 2 do labirinto resultante da fun&#231;&#227;o mazetocorridor de um labirinto &#236;mpar</p><p>t3maze0  -&gt; Tira o Corridor 3 do labirinto resultante da fun&#231;&#227;o mazetocorridor de um labirinto &#236;mpar</p><p>t4maze0  -&gt; Tira o Corridor 4 do labirinto resultante da fun&#231;&#227;o mazetocorridor de um labirinto &#236;mpar</p><p>t5maze0  -&gt; Tira o Corridor 5 do labirinto resultante da fun&#231;&#227;o mazetocorridor de um labirinto &#236;mpar</p><p>Notas adicionais : </p><p>Ao longo deste trabalho utiliza-se a conoto&#231;&#227;o Maze para os Labirintos e Corridores para os v&#225;rios corredores de cada labirinto </p><p><strong>Testes</strong> locais (servem para determinar se a fun&#231;&#227;o funciona ou n&#227;o)</p><p>Teste de comprimento e altura. Se der True ent&#227;o o comprimento e a altura est&#227;o certas</p></div></div><div class="top"><p class="src"><a id="v:altura" class="def">altura</a> :: Int -&gt; Int -&gt; Int -&gt; Bool <a href="#v:altura" class="selflink">#</a></p><div class="doc"><p>Testa se a altura est&#225; correta</p></div></div><div class="top"><p class="src"><a id="v:comprimento" class="def">comprimento</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; Bool <a href="#v:comprimento" class="selflink">#</a></p><div class="doc"><p>Compara o comprimento de cada corridor. Caso algum seja diferente do anterior d&#225; falso</p></div></div><div class="top"><p class="src"><a id="v:scnd" class="def">scnd</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:scnd" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o auxiliar. Utilizada para dar os segundos corredores dos labirintos</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>